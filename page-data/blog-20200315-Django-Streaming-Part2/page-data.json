{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog-20200315-Django-Streaming-Part2/","result":{"data":{"cur":{"id":"e56d1a5e-b653-5b22-8f18-06573b9cb420","html":"<h1 id=\"ì¤‘ê°„ë¶€í„°-ìŠ¤íŠ¸ë¦¬ë°\" style=\"position:relative;\"><a href=\"#%EC%A4%91%EA%B0%84%EB%B6%80%ED%84%B0-%EC%8A%A4%ED%8A%B8%EB%A6%AC%EB%B0%8D\" aria-label=\"ì¤‘ê°„ë¶€í„° ìŠ¤íŠ¸ë¦¬ë° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì¤‘ê°„ë¶€í„° ìŠ¤íŠ¸ë¦¬ë°</h1>\n<p>ì´ì „ì— ì‘ì„±í–ˆë˜ ìŠ¤íŠ¸ë¦¬ë° ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>\n<h3 id=\"viewspy\" style=\"position:relative;\"><a href=\"#viewspy\" aria-label=\"viewspy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>views.py</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">StreamTextView</span><span class=\"token punctuation\">(</span>View<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n            track_id    <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'track_id'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n            track       <span class=\"token operator\">=</span> Track<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span> <span class=\"token operator\">=</span> track_id<span class=\"token punctuation\">)</span>\n            music_url   <span class=\"token operator\">=</span> track<span class=\"token punctuation\">.</span>music_url\n            stream      <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>iteration<span class=\"token punctuation\">(</span>music_url<span class=\"token punctuation\">)</span>\n            response    <span class=\"token operator\">=</span> StreamingHttpResponse<span class=\"token punctuation\">(</span>stream<span class=\"token punctuation\">,</span> status <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> content_type <span class=\"token operator\">=</span> <span class=\"token string\">'text/event-stream'</span><span class=\"token punctuation\">)</span>\n            response<span class=\"token punctuation\">[</span><span class=\"token string\">'Cache-Control'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'no-cache'</span>\n\n            <span class=\"token keyword\">return</span> response\n        <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> identifier<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>indentifier<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">iteration</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> music_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>music_url<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb+'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n                c <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">if</span> c<span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">yield</span> c\n                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span></code></pre></div>\n<p>í”„ë¡ íŠ¸ì— fetch url ì„ ì£¼ê³ , ê·¸ URLì´ í˜¸ì¶œë  ë•Œ ìœ„ í´ë˜ìŠ¤ê°€ ì‹¤í–‰ë˜ë©´ ë…¸ë˜ê°€ ì €ì ˆë¡œ ì¬ìƒë˜ì—ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì§€ê¸ˆ ì½”ë“œë¡œëŠ” ë…¸ë˜ë¥¼ ì˜¤ë¡œì§€ ì²˜ìŒë¶€í„°ë§Œ ì¬ìƒí•  ìˆ˜ ìˆë‹¤. ì¤‘ê°„ë¶€í„° ì¬ìƒí•˜ë ¤ê³  ì¬ìƒë§‰ëŒ€ ê·¸ ì–´ë”˜ê°€ë¥¼ ëˆ„ë¥´ê²Œë˜ë©´, ë‹¤ì‹œ fetch urlì„ í˜¸ì¶œí•˜ëŠ” ê³¼ì •ì´ ë˜ê¸° ë•Œë¬¸ì— ë‹¤ì‹œ ë…¸ë˜ê°€ ì²˜ìŒë¶€í„° ì‹œì‘ëœë‹¤.</p>\n<p><strong>í–‰ë³µí•˜ì§€ ì•Šë‹¤.</strong></p>\n<h2 id=\"ì²«ë²ˆì§¸-ì‹œë„\" style=\"position:relative;\"><a href=\"#%EC%B2%AB%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\" aria-label=\"ì²«ë²ˆì§¸ ì‹œë„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì²«ë²ˆì§¸ ì‹œë„,</h2>\n<p>íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ” ë¶€ë¶„ì¸ <code class=\"language-text\">c = f.read()</code> ë¶€ë¶„ì— ì–´ë””ì„œ ì½ì„ì§€ ì‹œì‘ë¶€ë¶„ì„ ë„£ì–´ì£¼ëŠ” ë°©ë²•ì´ë‹¤. <code class=\"language-text\">c = f.read(sample_rate * second)</code> ì˜ í˜•íƒœì´ë‹¤. ì—¬ê¸°ì„œ sample rateë€ ìŒì•… íŒŒì¼ì—ì„œ ì´ˆë‹¹ ì½ì–´ì˜¤ëŠ” ë°ì´í„°ì˜ ì–‘ì´ë‹¤. ë”°ë¼ì„œ ì‹œì‘í•˜ê³ ì í•˜ëŠ” ìœ„ì¹˜ë¥¼ ì´ˆ(second)ì˜ í˜•íƒœë¡œ ê³±í•´ì£¼ë©´, íŒŒì¼ì—ì„œ ë‚´ê°€ ì‹œì‘í•˜ê³ ì í•˜ëŠ” ë¶€ë¶„ë¶€í„° ì½ì–´ì˜¬ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.<br>\nsample rateëŠ” ìŒì•…ë³„ë¡œ ë‹¤ë¥´ì§€ë§Œ, jamendo í™ˆí˜ì´ì§€ì—ì„œ ë‹¤ìš´ë°›ì€ ë¬´ë£Œ ìŒì›ì˜ sample rateì€ ê±°ì˜ ëª¨ë‘ 22050ì´ì—ˆë‹¤.</p>\n<h3 id=\"ê²°ê³¼-1\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-1\" aria-label=\"ê²°ê³¼ 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ê³¼ 1</h3>\n<p>ë°˜ë§Œ ì„±ê³µí•¨. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì§€ì •í•œ ìœ„ì¹˜ë¥¼ ë”°ë¡œ ì„¤ì •í•´ì„œ ë°›ì•„ì˜¤ëŠ” ê²ƒì€ ì‘ë™í•˜ì§€ ì•Šì•˜ê³ , second = 70 (ì´ˆ)ë¡œ ì„¤ì •í•´ë‘ë©´, ë§¤ë²ˆ 70ì´ˆì˜ ìœ„ì¹˜ì—ì„œ ë…¸ë˜ê°€ ì‹œì‘ë˜ê¸°ë§Œ í–ˆë‹¤ ã…‹ã…‹ã…‹</p>\n<h2 id=\"ë‘ë²ˆì§¸-ì‹œë„\" style=\"position:relative;\"><a href=\"#%EB%91%90%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\" aria-label=\"ë‘ë²ˆì§¸ ì‹œë„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë‘ë²ˆì§¸ ì‹œë„,</h2>\n<p>ìœ„ì— ì…ë ¥í•œ ì½”ë“œì˜ <code class=\"language-text\">response</code>ì— ë‹¤ë¥¸ attributeë¥¼ ì¶”ê°€í•´ì£¼ì—ˆë‹¤.</p>\n<ol>\n<li>response[â€˜Accept-Rangesâ€™] = â€˜bytesâ€™</li>\n<li>response[â€˜Content-Lengthâ€™] = len(open(â€˜media/â€˜+music_file, â€˜rbâ€™).read())</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MusicStreamingView</span><span class=\"token punctuation\">(</span>View<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        track_id    <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'track_id'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n        start_sec   <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'start_sec'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> track_id<span class=\"token punctuation\">:</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>track_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>track_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">return</span> JsonResponse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'message'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'INVALID_KEY'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> status <span class=\"token operator\">=</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\n\n            track       <span class=\"token operator\">=</span> Track<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span> <span class=\"token operator\">=</span> track_id<span class=\"token punctuation\">)</span>\n            music_file  <span class=\"token operator\">=</span> track<span class=\"token punctuation\">.</span>music_url\n            stream      <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>iteration<span class=\"token punctuation\">(</span><span class=\"token string\">'media/'</span><span class=\"token operator\">+</span>music_file<span class=\"token punctuation\">)</span>\n            response    <span class=\"token operator\">=</span> StreamingHttpResponse<span class=\"token punctuation\">(</span>stream<span class=\"token punctuation\">,</span> status <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\n\n            response<span class=\"token punctuation\">[</span><span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">]</span>        <span class=\"token operator\">=</span> <span class=\"token string\">'audio/mpeg'</span>\n            response<span class=\"token punctuation\">[</span><span class=\"token string\">'Accept-Ranges'</span><span class=\"token punctuation\">]</span>       <span class=\"token operator\">=</span> <span class=\"token string\">'bytes'</span>\n            response<span class=\"token punctuation\">[</span><span class=\"token string\">'Cache-Control'</span><span class=\"token punctuation\">]</span>       <span class=\"token operator\">=</span> <span class=\"token string\">'no-cache'</span>\n            response<span class=\"token punctuation\">[</span><span class=\"token string\">'Content-Length'</span><span class=\"token punctuation\">]</span>      <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'media/'</span><span class=\"token operator\">+</span>music_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            response<span class=\"token punctuation\">[</span><span class=\"token string\">'Content-Disposition'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'filename = </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>music_file<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span>\n\n            <span class=\"token keyword\">return</span> response\n\n        <span class=\"token keyword\">return</span> JsonResponse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'message'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'INVALID_KEYWORD'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> status <span class=\"token operator\">=</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">iteration</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> file_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>file_name<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb+'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n           <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n                content <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">if</span> content<span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">yield</span> content\n                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span></code></pre></div>\n<h3 id=\"ê²°ê³¼-2\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-2\" aria-label=\"ê²°ê³¼ 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ê³¼ 2</h3>\n<p>ì„±ê³µì„±ê³µ~</p>\n<h1 id=\"ìŒì•…-íŒŒì¼-unit-test\" style=\"position:relative;\"><a href=\"#%EC%9D%8C%EC%95%85-%ED%8C%8C%EC%9D%BC-unit-test\" aria-label=\"ìŒì•… íŒŒì¼ unit test permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìŒì•… íŒŒì¼ unit test</h1>\n<p>ìš”ì¦˜ ê°œë°œê³¼ ë™ì‹œì— ìœ ë‹›í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê³  ìˆë‹¤. ì¼ë°˜ <code class=\"language-text\">HttpResponse</code> ë‚˜ <code class=\"language-text\">JssonResponse</code>ì™€ëŠ” ë‹¬ë¦¬ Streaming musicì€ ì–´ë–»ê²Œ unit testë¥¼ í• ê¹Œ?</p>\n<p>ìš°ì„ ì€ ì§€ì •í•´ë‘” ë‚´ë¶€ ì†ì„±ë“¤ì´ ë‹¤ ì˜ ì „ë‹¬ë˜ì—ˆëŠ”ì§€ë¡œ í™•ì¸í•˜ê¸°ë¡œ í–ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">response<span class=\"token punctuation\">[</span><span class=\"token string\">'Content-Disposition'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'filename  = </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>music_file<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span></code></pre></div>\n<p>ì´ë ‡ê²Œ ì¶”ê°€í•´ë‘ê³ , test.py íŒŒì¼ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">StreamingTest</span><span class=\"token punctuation\">(</span>TestCase<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n     <span class=\"token keyword\">def</span> <span class=\"token function\">test_streaming_get_success</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n         client <span class=\"token operator\">=</span> Client<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n         response <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'/music/track?track_id=1'</span><span class=\"token punctuation\">)</span>\n         self<span class=\"token punctuation\">.</span>assertEqual<span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>\n             <span class=\"token string\">'Content-Disposition'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n             <span class=\"token string\">\"filename = DR_GROOVE_GANG_-_A_l_ancienne.mp3\"</span>\n         <span class=\"token punctuation\">)</span>\n         self<span class=\"token punctuation\">.</span>assertEqual<span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>status_code<span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ìš°ì„  ì—¬ê¸°ê¹Œì§€ë¡œ íƒ€í˜‘ !</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<ul>\n<li><a href=\"#viewspy\">views.py</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%B2%AB%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\">ì²«ë²ˆì§¸ ì‹œë„,</a></p>\n<ul>\n<li><a href=\"#%EA%B2%B0%EA%B3%BC-1\">ê²°ê³¼ 1</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%91%90%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\">ë‘ë²ˆì§¸ ì‹œë„,</a></p>\n<ul>\n<li><a href=\"#%EA%B2%B0%EA%B3%BC-2\">ê²°ê³¼ 2</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"ì¤‘ê°„ë¶€í„° ìŠ¤íŠ¸ë¦¬ë° ì´ì „ì— ì‘ì„±í–ˆë˜ ìŠ¤íŠ¸ë¦¬ë° ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤. views.py í”„ë¡ íŠ¸ì— fetch url ì„ ì£¼ê³ , ê·¸ URLì´ í˜¸ì¶œë  ë•Œ ìœ„ í´ë˜ìŠ¤ê°€ ì‹¤í–‰ë˜ë©´ ë…¸ë˜ê°€ ì €ì ˆë¡œ ì¬ìƒë˜ì—ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì§€ê¸ˆ ì½”ë“œë¡œëŠ” ë…¸ë˜ë¥¼ ì˜¤ë¡œì§€ ì²˜ìŒë¶€í„°ë§Œ ì¬ìƒí•  ìˆ˜ ìˆë‹¤. ì¤‘ê°„ë¶€í„° ì¬ìƒí•˜ë ¤ê³  ì¬ìƒë§‰ëŒ€ ê·¸ ì–´ë”˜ê°€ë¥¼ ëˆ„ë¥´ê²Œë˜ë©´, ë‹¤ì‹œ fetch urlì„ í˜¸ì¶œí•˜ëŠ” ê³¼ì •ì´ ë˜ê¸° ë•Œë¬¸ì— ë‹¤ì‹œ ë…¸ë˜ê°€ ì²˜ìŒë¶€í„° ì‹œì‘ëœë‹¤. í–‰ë³µí•˜ì§€ ì•Šë‹¤. ì²«ë²ˆì§¸ ì‹œë„, íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ” ë¶€ë¶„ì¸  ë¶€ë¶„ì— ì–´ë””ì„œ ì½ì„ì§€ ì‹œì‘ë¶€ë¶„ì„ ë„£ì–´ì£¼ëŠ” ë°©ë²•ì´ë‹¤.  ì˜ í˜•íƒœì´ë‹¤. ì—¬ê¸°ì„œ sample rateë€ ìŒì•… íŒŒì¼ì—ì„œ ì´ˆë‹¹ ì½ì–´ì˜¤ëŠ” ë°ì´í„°ì˜ ì–‘ì´ë‹¤. ë”°ë¼ì„œ ì‹œì‘í•˜ê³ ì í•˜ëŠ” ìœ„ì¹˜ë¥¼ ì´ˆ(second)ì˜ í˜•íƒœë¡œ ê³±í•´ì£¼ë©´, íŒŒì¼ì—ì„œ ë‚´ê°€ ì‹œì‘í•˜ê³ ì í•˜ëŠ” ë¶€ë¶„ë¶€í„° ì½ì–´ì˜¬ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. sample rateëŠ” ìŒì•…ë³„ë¡œ ë‹¤ë¥´ì§€ë§Œ, jamendo í™ˆí˜ì´ì§€ì—ì„œ ë‹¤ìš´ë°›ì€ ë¬´ë£Œ ìŒì›ì˜ sample rateì€ ê±°ì˜ ëª¨ë‘ 22050ì´ì—ˆë‹¤. ê²°ê³¼ 1 ë°˜ë§Œ ì„±ê³µí•¨.â€¦","frontmatter":{"date":"March 15, 2020","title":"Djangoë¡œ ìŠ¤íŠ¸ë¦¬ë° í•˜ê¸° part2 - ì¤‘ê°„ ì¬ìƒê³¼ Unit test","categories":"ê°œë°œë¸”ë¡œê·¸","author":"ì´ì†Œí—Œ","emoji":"ğŸ‘‘"},"fields":{"slug":"/blog-20200315-Django-Streaming-Part2/"}},"next":{"id":"d966eff6-89e9-59de-b7a5-1c82bc703b2a","html":"<p>Djangoì—ì„œëŠ” ê¸°ë³¸ ë°ì´í„° ë² ì´ìŠ¤ë¡œ sqlite3ë¥¼ ì œê³µí•´ì¤€ë‹¤. setting.py íŒŒì¼ì„ ë³´ë©´ sqlite3ì— ëŒ€í•œ ì„¤ì •ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ì™€ ê°™ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">DATABASES <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'default'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'ENGINE'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'django.db.backends.sqlite3'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'NAME'</span><span class=\"token punctuation\">:</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>BASE_DIR<span class=\"token punctuation\">,</span> <span class=\"token string\">'db.sqlite3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ë‚˜ëŠ” ì•ìœ¼ë¡œ MySQLì„ ì‚¬ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì—, ì´ ê¸°ë³¸ ì •ë³´ë¥¼ ë°”ê¾¸ê³  Django-MySQL ì¡°í•©ì„ ì™„ì„±í•˜ë ¤ í•œë‹¤.</p>\n<hr>\n<h3 id=\"ìš°ë¶„íˆ¬-mysql-ì„¤ì¹˜\" style=\"position:relative;\"><a href=\"#%EC%9A%B0%EB%B6%84%ED%88%AC-mysql-%EC%84%A4%EC%B9%98\" aria-label=\"ìš°ë¶„íˆ¬ mysql ì„¤ì¹˜ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìš°ë¶„íˆ¬ MySQL ì„¤ì¹˜</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y mysql-server\n$ <span class=\"token function\">sudo</span> mysql_secure_installation\n<span class=\"token punctuation\">[</span>NO<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>ìµœê³ ê´€ë¦¬ì password<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>Y:ìµëª… ì‚¬ìš©ì ì œê±°<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>N:ì™¸ë¶€ ë¡œê·¸ì¸ í—ˆìš©<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>Y:í…ŒìŠ¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œ<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>Y:privilege table ë‹¤ì‹œ ë¡œë“œ<span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"í™˜ê²½-êµ¬ì„±\" style=\"position:relative;\"><a href=\"#%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1\" aria-label=\"í™˜ê²½ êµ¬ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>í™˜ê²½ êµ¬ì„±</h3>\n<p>djangoê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ê°€ìƒí™˜ê²½ì„ í™œì„±í™”í•œ ë’¤, <code class=\"language-text\">mysqlclient</code>ë¥¼ ì„¤ì¹˜í•œë‹¤. ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ ì—°ë™í•  ê²ƒì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pip <span class=\"token function\">install</span> mysqlclient</code></pre></div>\n<h5 id=\"ìš°ë¶„íˆ¬ì—ì„œ-mysqlclient-ì„¤ì¹˜ì‹œ-ì˜¤ë¥˜ê°€-ë°œìƒí•œë‹¤ë©´\" style=\"position:relative;\"><a href=\"#%EC%9A%B0%EB%B6%84%ED%88%AC%EC%97%90%EC%84%9C-mysqlclient-%EC%84%A4%EC%B9%98%EC%8B%9C-%EC%98%A4%EB%A5%98%EA%B0%80-%EB%B0%9C%EC%83%9D%ED%95%9C%EB%8B%A4%EB%A9%B4\" aria-label=\"ìš°ë¶„íˆ¬ì—ì„œ mysqlclient ì„¤ì¹˜ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìš°ë¶„íˆ¬ì—ì„œ mysqlclient ì„¤ì¹˜ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´,</h5>\n<p style=\"background-color:pink; padding:5px\">Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-install-zbw18e9_/mysqlclient/  </p>\n<p>ì´ëŸ° ì—ëŸ¬.<br>\në˜ëŠ”,</p>\n<p style=\"background-color:pink; padding:5px\">/bin/sh: 1: mysql_config: not found  </p>\n<p>ì´ëŸ° ì—ëŸ¬.<br>\nì´ë•Œ,</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> libmysqlclient-dev</code></pre></div>\n<p>ë‹¤ì‹œ</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> mysqlclient</code></pre></div>\n<h3 id=\"mysqlì—-ë°ì´í„°ë² ì´ìŠ¤-ìƒì„±\" style=\"position:relative;\"><a href=\"#mysql%EC%97%90-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%83%9D%EC%84%B1\" aria-label=\"mysqlì— ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MySQLì— ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±</h3>\n<p>í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ ì´ìš©í•  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ MySQL ë‚´ë¶€ì— ë§Œë“¤ì–´ì£¼ì. starbucks ë¼ëŠ” ë°ì´í„° ë² ì´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">mysql<span class=\"token operator\">></span> <span class=\"token keyword\">create</span> <span class=\"token keyword\">database</span> starbucks <span class=\"token keyword\">character</span> <span class=\"token keyword\">set</span> utf8mb4 <span class=\"token keyword\">collate</span> utf8mb4_general_ci<span class=\"token punctuation\">;</span>\nQuery OK<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> <span class=\"token keyword\">row</span> affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.01</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<p>character set utf8mb4 - í•œê¸€ ì‚¬ìš© í™œì„±í™”</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">mysql<span class=\"token operator\">></span> <span class=\"token keyword\">use</span> starbucks\n<span class=\"token keyword\">Database</span> changed\nmysql<span class=\"token operator\">></span> <span class=\"token keyword\">show</span> <span class=\"token keyword\">tables</span><span class=\"token punctuation\">;</span>\nEmpty <span class=\"token keyword\">set</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì§€ê¸ˆì€ ì•„ë¬´ í…Œì´ë¸”ë„ ì—†ì§€ë§Œ, ì•ìœ¼ë¡œ ì´ê²ƒ ì €ê²ƒ ë„£ìœ¼ë©´ ëœë‹¤.</p>\n<h5 id=\"-ë°ì´í„°ë² ì´ìŠ¤-ì‚­ì œí•˜ë ¤ë©´\" style=\"position:relative;\"><a href=\"#-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%82%AD%EC%A0%9C%ED%95%98%EB%A0%A4%EB%A9%B4\" aria-label=\" ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œí•˜ë ¤ë©´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>â” ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œí•˜ë ¤ë©´</h5>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DROP DATABASE &lt;database_name></code></pre></div>\n<h3 id=\"django-mysql-ì—°ë™\" style=\"position:relative;\"><a href=\"#django-mysql-%EC%97%B0%EB%8F%99\" aria-label=\"django mysql ì—°ë™ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Django-MySQL ì—°ë™</h3>\n<p>ì—¬íƒœ settings.pyì— ëª¨ë“  ì •ë³´ë¥¼ ëª°ì•„ì„œ ì €ì¥í–ˆì§€ë§Œ, ì§€ê¸ˆë¶€í„°ëŠ” my_settings.pyë¼ëŠ” ìƒˆë¡œìš´ íŒŒì¼ì— ë¯¼ê°í•œ ì •ë³´ë“¤ì„ ë”°ë¡œ ì €ì¥í•´ë‘ê³ , settings.pyì—ì„œ import í•´ì„œ ì‚¬ìš©í•  ê²ƒì´ë‹¤.</p>\n<blockquote>\n<p class=\"quote\" style=\"max-width: 100%; padding:10px; border-left:solid 3px gray; text-align:left\"> my_settings.py íŒŒì¼ì€ ì™¸ë¶€ì™€ ê³µìœ í•  ì¼ì´ ì—†ëŠ” ì •ë³´ì´ê¸° ë•Œë¬¸ì— .gitignoreì´ë¼ëŠ” ìˆ¨ê¹€ íŒŒì¼ì— ì´ë¦„ì„ ë“±ë¡í•˜ì—¬ githubì— ì—…ë¡œë“œ ë˜ì§€ ì•Šë„ë¡ ë§Œë“¤ì–´ì•¼ í•œë‹¤.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> my_settings.py</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">DATABASES <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'default'</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">'ENGINE'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'django.db.backends.mysql'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'NAME'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'starbucks'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'USER'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'PASSWORD'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'HOST'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'PORT'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3306'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">my_settings.py</code>íŒŒì¼ì´ ì™„ì„±ë˜ì—ˆë‹¤. ê·¸ëŸ¼ ì§„ì§œ <code class=\"language-text\">setting.py</code>íŒŒì¼ì—ì„œ importí•˜ëŸ¬ ê°€ì!</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> settings.py</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> my_settings\n\nDATABASES <span class=\"token operator\">=</span> my_settings<span class=\"token punctuation\">.</span>DATABASES</code></pre></div>\n<p>ëª¨ë“  ì„¤ì •ì„ ìˆ˜ì •í•˜ì˜€ë‹¤ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì¤˜ì•¼í•œë‹¤. <code class=\"language-text\">./manage.py migrate</code></p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">mysql<span class=\"token operator\">></span> <span class=\"token keyword\">use</span> starbucks\nmysql<span class=\"token operator\">></span> <span class=\"token keyword\">show</span> <span class=\"token keyword\">tables</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">ì¥ê³ _ì–´ì©Œêµ¬</code> ì„¸ í…Œì´ë¸”ê³¼, ë‚´ê°€ starbucks_menu.modelsì— ë§Œë“¤ì–´ ë‘” í´ë˜ìŠ¤ì— í•´ë‹¹í•˜ëŠ” í‘œë“¤ì´ ë³´ì¸ë‹¤.</p>\n<hr>\n<p>ì´ì œ ì“°ë©´ ëœë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%9A%B0%EB%B6%84%ED%88%AC-mysql-%EC%84%A4%EC%B9%98\">ìš°ë¶„íˆ¬ MySQL ì„¤ì¹˜</a></li>\n<li>\n<p><a href=\"#%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1\">í™˜ê²½ êµ¬ì„±</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%EC%9A%B0%EB%B6%84%ED%88%AC%EC%97%90%EC%84%9C-mysqlclient-%EC%84%A4%EC%B9%98%EC%8B%9C-%EC%98%A4%EB%A5%98%EA%B0%80-%EB%B0%9C%EC%83%9D%ED%95%9C%EB%8B%A4%EB%A9%B4\">ìš°ë¶„íˆ¬ì—ì„œ mysqlclient ì„¤ì¹˜ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´,</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#mysql%EC%97%90-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%83%9D%EC%84%B1\">MySQLì— ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%82%AD%EC%A0%9C%ED%95%98%EB%A0%A4%EB%A9%B4\">â” ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œí•˜ë ¤ë©´</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#django-mysql-%EC%97%B0%EB%8F%99\">Django-MySQL ì—°ë™</a></li>\n</ul>\n</div>","frontmatter":{"date":"February 17, 2020","title":"Djangoì— MySQL ì—°ê²°í•˜ì—¬ ë°ì´í„° ì €ì¥í•˜ê¸°","categories":"ê°œë°œë¸”ë¡œê·¸","author":"ì´ì†Œí—Œ","emoji":"ğŸ‘‘"},"fields":{"slug":"/blog-20200217-Django-Connect-MySQL/"}},"prev":{"id":"7df99284-96e3-5b5e-86a2-b294951ef2d7","html":"<p>íŒŒì´ì¬ìœ¼ë¡œ ë‹¤ì–‘í•œ ê°ì²´ë“¤ì„ ë‹¤ë£¨ë‹¤ë³´ë©´ ì¢…ì¢… <code class=\"language-text\">with open</code>ì„ ì‚¬ìš©í•œë‹¤.<br>\níŠ¹íˆ íŒŒì¼ì„ ì—´ ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•˜ëŠ”ë°, í…ìŠ¤íŠ¸(.txt) íŒŒì¼ì„ í™œìš©í•˜ì—¬ ì‘ì—…í•  ë•ŒëŠ” ë¬¼ë¡ ì´ë©° ìŒì•… íŒŒì¼ì„ ë‹¤ë£° ë•Œì—ë„ ì–´ê¹€ì—†ì´ ë“±ì¥í•œë‹¤.</p>\n<ul>\n<li><a style=\"color:orange; text-decoration:none; font-weight:800\" href='https://soheon-lee.github.io/blog-20200315-Django-Streaming-Part1/'> Djangoë¡œ ìŒì•… ìŠ¤íŠ¸ë¦¬ë°í•˜ê¸° PART1</a></li>\n<li><a style=\"color:orange; text-decoration:none; font-weight:800\" href='https://soheon-lee.github.io/blog-20200315-Django-Streaming-Part2/'> Djangoë¡œ ìŒì•… ìŠ¤íŠ¸ë¦¬ë°í•˜ê¸° PART2</a></li>\n</ul>\n<p>í˜„ì¬ ì§„í–‰ì¤‘ì¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” database ë¡œ ì—°ê²°ë˜ëŠ” connectionì„ ì—´ê³  ë‹«ì„ ë•Œë„ ì‚¬ìš©í•˜ê³  ìˆë‹¤.<br>\nê·¸ë ‡ë‹¤ë©´ ì´ ê¸°ëŠ¥ì˜ ì •ì²´ëŠ” ë¬´ì—‡ì¼ê¹Œ? ë‚˜ë§Œì˜ ë°ì´í„°ë„ with openìœ¼ë¡œ ì—´ ìˆ˜ ìˆì„ê¹Œ?</p>\n<h1 id=\"python-with-\" style=\"position:relative;\"><a href=\"#python-with-\" aria-label=\"python with  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Python â€˜withâ€™ ?</h1>\n<p>íŒŒì´ì¬ì„ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒì´ë¼ë©´, ì•„ë˜ êµ¬ë¬¸ì´ ê½¤ë‚˜ ìµìˆ™í•  ê²ƒì´ë‹¤. withì€ ì‰½ê²Œ ë§í•´ ì•„ë˜ êµ¬ë¬¸ì„ <strong>í•œ ë‹¨ì–´ë¡œ í•©ì³ë†“ì€ ê²ƒ</strong>ì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token builtin\">set</span> things up\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n  do something\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n  tear things down</code></pre></div>\n<p>ì—¬ê¸°ì„œ <code class=\"language-text\">set things up</code> êµ¬ë¬¸ì€ íŒŒì¼ì„ ì—¬ëŠ” ë“±ì˜ ëª…ë ¹ì¸ë°, ì—´ê³  ë‚˜ì„œ <code class=\"language-text\">something</code>ì„ í•˜ê³ , ê·¸ ëª…ë ¹ì´ ëë‚˜ê³  ë‚˜ë©´, ê²°ê³¼ ì—¬ë¶€ì— ìƒê´€ì—†ì´ (suceeded or not) <code class=\"language-text\">tear things down</code> í•˜ë¼ëŠ” êµ¬ë¬¸ì´ë‹¤.<br>\nì˜ˆë¥¼ ë“¤ì–´, pythonì—ì„œ mysql.connector ë¼ëŠ” ì»¤ë„¥í„°ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ì—°ê²°ì„ ì—°ë‹¤ê³  ê°€ì •í•´ë³´ì.<br>\n(mysqlì— ê´€í•œ ì•„ë˜ ì„¤ì •ì€ ë¬´ì‹œí•´ë„ ì¢‹ë‹¤.)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">db_connection <span class=\"token operator\">=</span> mysql<span class=\"token punctuation\">.</span>connector<span class=\"token punctuation\">.</span>connect\n  <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'database'</span><span class=\"token operator\">=</span>DATABASE<span class=\"token punctuation\">[</span><span class=\"token string\">'database'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'user'</span><span class=\"token operator\">=</span>DATABASE<span class=\"token punctuation\">[</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n  db_cursor <span class=\"token operator\">=</span> db_connection<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n  db_cursor<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ol>\n<li>ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ ë§Œë“ ë‹¤ (ì—°ë‹¤).</li>\n<li>ì»¤ì„œë¥¼ ì—°ê²°í•œë‹¤.</li>\n<li>ì»¤ì„œë¥¼ ë‹«ëŠ”ë‹¤.</li>\n</ol>\n<p>ìœ„ì˜ ì½”ë“œëŠ” íŒŒì¼ì„ ì—´ê³  ì–´ë–¤ ëª…ë ¹ì„ ë‚´ë¦¬ê³  ì €ê±¸ ë‹¤ì‹œ ë‹«ëŠ” ë‹¨ìˆœ ê³¼ì •ì´ë‹¤. ë”±!! í•¨ìˆ˜í™”í•˜ê¸°ì— ì ë‹¹í•œ ê³¼ì •ì´ ì•„ë‹Œê°€?</p>\n<h3 id=\"ì´-ëª¨ë“ -ê³¼ì •ì„-í•œ-ë²ˆì—-ì²˜ë¦¬í•˜ê¸°-ìœ„í•´-ì¡´ì¬í•˜ëŠ”-ê²ƒì´-withì´ë‹¤\" style=\"position:relative;\"><a href=\"#%EC%9D%B4-%EB%AA%A8%EB%93%A0-%EA%B3%BC%EC%A0%95%EC%9D%84-%ED%95%9C-%EB%B2%88%EC%97%90-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0-%EC%9C%84%ED%95%B4-%EC%A1%B4%EC%9E%AC%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%B4-with%EC%9D%B4%EB%8B%A4\" aria-label=\"ì´ ëª¨ë“  ê³¼ì •ì„ í•œ ë²ˆì— ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì¡´ì¬í•˜ëŠ” ê²ƒì´ withì´ë‹¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì´ ëª¨ë“  ê³¼ì •ì„ í•œ ë²ˆì— ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì¡´ì¬í•˜ëŠ” ê²ƒì´ â€˜withâ€™ì´ë‹¤.</h3>\n<h1 id=\"ê°ì²´-ìƒì„±\" style=\"position:relative;\"><a href=\"#%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1\" aria-label=\"ê°ì²´ ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê°ì²´ ìƒì„±</h1>\n<p>íŒŒì´ì¬ì˜ ê±°ì˜ ëª¨ë“  ìë£Œí˜•ì€ <strong>ê°ì²´</strong>ë‹¤. ì–´ë–¤ ê°ì²´ë¥¼ <code class=\"language-text\">with</code>ìœ¼ë¡œ ì—´ê³  ì‹¶ë‹¤ë©´, ê·¸ ê°ì²´ì˜ ê¸°ë³¸ ë©”ì†Œë“œë¡œ <code class=\"language-text\">__enter__</code>ê³¼ <code class=\"language-text\">__exit__</code>ì´ í•„ìš”í•˜ë‹¤.</p>\n<h3 id=\"__enter__--ê°ì²´ê°€-ì—´ë¦¬ìë§ˆì-ì‹¤í–‰\" style=\"position:relative;\"><a href=\"#__enter__--%EA%B0%9D%EC%B2%B4%EA%B0%80-%EC%97%B4%EB%A6%AC%EC%9E%90%EB%A7%88%EC%9E%90-%EC%8B%A4%ED%96%89\" aria-label=\"__enter__  ê°ì²´ê°€ ì—´ë¦¬ìë§ˆì ì‹¤í–‰ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>__enter__ : ê°ì²´ê°€ ì—´ë¦¬ìë§ˆì ì‹¤í–‰</h3>\n<h3 id=\"__exit__-ê°ì²´ê°€-ë‹«íë•Œ-ì‹¤í–‰\" style=\"position:relative;\"><a href=\"#__exit__-%EA%B0%9D%EC%B2%B4%EA%B0%80-%EB%8B%AB%ED%9E%90%EB%95%8C-%EC%8B%A4%ED%96%89\" aria-label=\"__exit__ ê°ì²´ê°€ ë‹«íë•Œ ì‹¤í–‰ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>__exit__: ê°ì²´ê°€ ë‹«íë•Œ ì‹¤í–‰</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">contolled_execution</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">__enter__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token builtin\">set</span> things up\n    <span class=\"token keyword\">return</span> thing\n\n  <span class=\"token keyword\">def</span> <span class=\"token function\">__exit__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> traceback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    tear things down\n\n<span class=\"token keyword\">with</span> controlled_execution<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> thing<span class=\"token punctuation\">:</span>\n  some code using thing</code></pre></div>\n<p><code class=\"language-text\">with</code>êµ¬ë¬¸ì´ ì‹¤í–‰ë˜ë©´, <strong>context manager</strong>ì´ ìë™ìœ¼ë¡œ <code class=\"language-text\">__enter__</code> ë©”ì†Œë“œë¡œ ì •ì˜ëœ ë™ì‘ì„ ìˆ˜í–‰í•˜ê³ , ì´ ë©”ì†Œë“œì˜ ê²°ê³¼ë¡œ ë°˜í™˜í•˜ëŠ” <code class=\"language-text\">return</code>ê°’ì„ <code class=\"language-text\">as</code>ë¥¼ ì‚¬ìš©í•´ thingsì— ì €ì¥í•œë‹¤. Pythonì´ ì½”ë“œì˜ ë‹¤ë¥¸ body ë¶€ë¶„ì„ ìˆ˜í–‰í•œ ë‹¤ìŒì—ëŠ” ê·¸ ê²°ê³¼ê°€ ì–´ë– í•˜ë“  (finally) <code class=\"language-text\">__exit__</code> ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ê²Œ ëœë‹¤.<br>\nì•ì„œ ì˜ˆì‹œë¡œ ë“  mysql database connection ì— ì´ ë°©ë²•ì„ ì ìš©í•´ë³´ì.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DatabaseConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__enter__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      self<span class=\"token punctuation\">.</span>cursor <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>db_connection<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span>buffered<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> dictionary<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>cursor\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__exit__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> exc_type<span class=\"token punctuation\">,</span> exc_value<span class=\"token punctuation\">,</span> exc_trance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    self<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndatabase_connection_cursor <span class=\"token operator\">=</span> DatabaseConnection<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> database_connection_cursor <span class=\"token keyword\">as</span> db_cursor<span class=\"token punctuation\">:</span>\n    db_cursor<span class=\"token punctuation\">.</span>do_something</code></pre></div>\n<h1 id=\"file-ê°ì²´ëŠ”-ì–´ë–¤-ëª¨ì–‘ì¸ê°€\" style=\"position:relative;\"><a href=\"#file-%EA%B0%9D%EC%B2%B4%EB%8A%94-%EC%96%B4%EB%96%A4-%EB%AA%A8%EC%96%91%EC%9D%B8%EA%B0%80\" aria-label=\"file ê°ì²´ëŠ” ì–´ë–¤ ëª¨ì–‘ì¸ê°€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>file ê°ì²´ëŠ” ì–´ë–¤ ëª¨ì–‘ì¸ê°€?</h1>\n<p>ìš°ë¦¬ê°€ ìì£¼ with open êµ¬ë¬¸ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” file ê°ì²´ë„ ì‚¬ì‹¤ ëœ¯ì–´ë³´ë©´ <code class=\"language-text\">__enter__</code>ê³¼ <code class=\"language-text\">__exit__</code>ì´ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x.txt\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> f\n<span class=\"token operator\">&lt;</span><span class=\"token builtin\">open</span> <span class=\"token builtin\">file</span> <span class=\"token string\">'x.txt'</span><span class=\"token punctuation\">,</span> mode <span class=\"token string\">'r'</span> at <span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> f<span class=\"token punctuation\">.</span>__enter__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span><span class=\"token builtin\">open</span> <span class=\"token builtin\">file</span> <span class=\"token string\">'x.txt'</span><span class=\"token punctuation\">,</span> mode <span class=\"token string\">'r'</span> at <span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> f<span class=\"token punctuation\">.</span>__exit__<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span></code></pre></div>\n<p>ê·¸ë˜ì„œ ìš°ë¦¬ê°€ with file openì„ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆë‹¤.</p>\n<hr>\n<p>ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ì–‘í•œ ê°ì²´ë¥¼ ì‘ìš©í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ì´ ë°©ë²•â€¦ pymysql ëª¨ë“ˆ ì“°ë©´ ë‹¤ ì•Œì•„ì„œ í•´ì¤€ë‹¤â€¦ ìˆëŠ” ìë£Œ ì˜ í™œìš©í•˜ëŠ” ë²•ë„ í„°ë“í•´ë³´ì ..ã…â€¦</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%9D%B4-%EB%AA%A8%EB%93%A0-%EA%B3%BC%EC%A0%95%EC%9D%84-%ED%95%9C-%EB%B2%88%EC%97%90-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0-%EC%9C%84%ED%95%B4-%EC%A1%B4%EC%9E%AC%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%B4-with%EC%9D%B4%EB%8B%A4\">ì´ ëª¨ë“  ê³¼ì •ì„ í•œ ë²ˆì— ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì¡´ì¬í•˜ëŠ” ê²ƒì´ â€˜withâ€™ì´ë‹¤.</a></li>\n<li><a href=\"#__enter__--%EA%B0%9D%EC%B2%B4%EA%B0%80-%EC%97%B4%EB%A6%AC%EC%9E%90%EB%A7%88%EC%9E%90-%EC%8B%A4%ED%96%89\">__enter__ : ê°ì²´ê°€ ì—´ë¦¬ìë§ˆì ì‹¤í–‰</a></li>\n<li><a href=\"#__exit__-%EA%B0%9D%EC%B2%B4%EA%B0%80-%EB%8B%AB%ED%9E%90%EB%95%8C-%EC%8B%A4%ED%96%89\">__exit__: ê°ì²´ê°€ ë‹«íë•Œ ì‹¤í–‰</a></li>\n</ul>\n</div>","frontmatter":{"date":"April 05, 2020","title":"With asë¡œ ì—´ ìˆ˜ ìˆëŠ” íŒŒì´ì¬ ê°ì²´ ìƒì„±í•˜ê¸°","categories":"ê°œë°œë¸”ë¡œê·¸","author":"ì´ì†Œí—Œ","emoji":"ğŸ‘‘"},"fields":{"slug":"/blog-20200405-With-as-Python-Object/"}},"site":{"siteMetadata":{"siteUrl":"https://www.zoomkoding.com","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/blog-20200315-Django-Streaming-Part2/","nextSlug":"/blog-20200217-Django-Connect-MySQL/","prevSlug":"/blog-20200405-With-as-Python-Object/"}},"staticQueryHashes":["1073350324","2938748437"]}